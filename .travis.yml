language: go
go:
- 1.12.x
install:
- curl -sfL https://install.goreleaser.com/github.com/golangci/golangci-lint.sh |
  sh -s -- -b $(go env GOPATH)/bin v1.20.0
script:
- golangci-lint run --disable-all --enable=vet --enable=ineffassign --enable=goconst
  --tests ./...
- go test -v -race ./...
before_script:
- echo "REPO $TRAVIS_REPO_SLUG TAG ${TRAVIS_TAG}"
deploy:
- provider: script
  script: curl -sL https://git.io/goreleaser | bash
  skip_cleanup: true
  on:
    tags: true
    condition: "$TRAVIS_OS_NAME = linux"
after_deploy:
- git clone https://github.com/sensu/sensu-go-bonsai-asset.git bonsai
- bonsai/generate-sha512sum.sh
- bonsai/github-release-upload.sh github_api_token=$GITHUB_TOKEN repo_slug="$TRAVIS_REPO_SLUG"
  tag="${TRAVIS_TAG}" filename="dist/$(cat dist/sha512_file)"
env:
  global:
  - GO111MODULE=on
  - secure: RlKUQuKYEm0rp/c8Gp1EaPNtVsqomacMdaUBA4v58w+HaQ2rSdwbBb5oqPA/t0AG51/1pD980DgBHCQa3x8XMiOl6vH3xg79LPP05Xbs6HVXli/8bKddPVQXXN1O7PF4RCwff1BmlEJKHc3S5AFAFwkSYBaGtF7aEc/pUms++X/npZRBejpFPOPaOGbKtXx4FrGWAhTm50IFt0iFc33+d5WApdzb8OG+KTK7h5YVlQmdTfXwx2oG84Go+ylTgcN+NUtAHG+qToSC1F6x/TPYGWJziiu24fhNu+ezvMjBXxAHjaBPliCn0jVqpVlOJ0FsAkJ492++5+0xonkeCi40Dk3y4VWfyvaf3vjJdFFDsPmK0/1rsi/ENYE7bNbnnhDoYCs5W4nqItldQeCOicuN+o2P4dhCQDSUQyq8ubhpRiQ9B8uWL4onAwLHoiSlxAyM6QWd0K3GAS7N7DGC1Dz56zYabs0wGZGRGstmSAGk2Xg4+VbAxzC0F5XCJ/8/pZcBtksyEOipLYQEoA0oVVSX2sGCH6QIY6JQAKNw//W82yi7d2rb/o1AJmj73ler81pTD9BCSa5NMY6ik9REC3swx0nZJSeSQV7Bxwah/nfyPynapDVvSW9ddjrjwRxY3natWWvYvciJAMGMby+FTl3g1s2QQP4c255u46krEiVmK1g=
